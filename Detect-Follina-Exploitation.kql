//Detects the exploitation of Follina Microsoft Code Execution vulnerability
SecurityEvent 
| where EventID==4688 
| where ParentProcessName has_any ('winword.exe','excel.exe','outlook.exe') 
| where NewProcessName contains "msdt.exe" or CommandLine contains "msdt.exe"


//The below query could return false-positives please verify the output and modify the query according to your environment.
SecurityEvent 
| where EventID==4688 
| where ParentProcessName has_any ('sdiagnhost.exe')
| project TimeGenerated, NewProcessId, NewProcessName, ParentProcessName, CommandLine, EventID, Activity, Computer
